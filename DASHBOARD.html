<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Yaris Cross Dashboard Digital</title>
  <!-- Fuente OpelSansBold -->
  <style>
    @font-face {
      font-family: 'OpelSansBold';
      src: url('https://205rallye.github.io/fuentes_web/OpelSans-Bold.woff') format('woff');
      font-weight: bold;
      font-style: normal;
    }
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(120deg, #20262e 0%, #222930 80%);
      color: #ffe27c;
      font-family: 'OpelSansBold', Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding-top: 30px;
    }
    .dashboard-container {
      display: flex;
      gap: 44px;
      align-items: flex-start;
      justify-content: center;
      flex-wrap: wrap;
      width: 97vw;
      max-width: 1240px;
    }
    .gauges-col {
      display: flex;
      flex-direction: column;
      gap: 36px;
      align-items: center;
      justify-content: center;
    }
    .gauge-blocks {
      display: flex;
      gap: 36px;
      justify-content: center;
    }
    .digital-panels {
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-left: 36px;
      margin-top: 22px;
    }
    .digital-panel {
      background: linear-gradient(90deg, #1e2229 90%, #2c3036 100%);
      border: 2.2px solid #484a4f;
      border-radius: 17px;
      padding: 13px 34px 10px 28px;
      color: #3cffb8;
      font-size: 1.36em;
      min-width: 185px;
      box-shadow: 0 2px 15px #0007;
      font-family: 'OpelSansBold', Arial, sans-serif;
      letter-spacing: 1px;
      text-shadow: 0 0 2px #222, 0 2px 8px #00ffbe33;
      display: flex; align-items: center; justify-content: space-between;
    }
    .digital-panel .label {
      color: #ffd572;
      font-size: 0.88em;
      margin-right: 15px;
      font-weight: normal;
      text-shadow: none;
    }
    .toyota-flow {
      background: linear-gradient(180deg,#222 90%,#264 100%);
      border-radius: 25px;
      box-shadow: 0 6px 30px #000c;
      margin-top: 16px;
      padding: 18px 28px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .toyota-flow h3 {
      margin: 0 0 6px 0;
      color: #7ecbff;
      font-size: 1.18em;
      letter-spacing: 1px;
    }
    #flow-canvas {
      display: block;
      background: #19252d;
      border-radius: 18px;
      box-shadow: 0 3px 10px #0009;
      margin: 0 auto;
    }
    .status-carga {
      font-size: 1.1em;
      margin-top: 9px;
      color: #b2ff9c;
      letter-spacing: 1px;
    }
    @media (max-width: 1100px) {
      .dashboard-container { flex-direction: column; align-items: center; gap: 24px;}
      .gauges-col, .digital-panels { margin-left: 0; margin-top: 0;}
      .gauge-blocks { gap: 22px;}
    }
    @media (max-width: 700px) {
      .gauge-blocks { flex-direction: column; gap: 18px;}
      .digital-panel { font-size: 1em; min-width: 130px;}
      .toyota-flow { padding: 8px 5vw;}
      #flow-canvas { max-width: 94vw;}
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@bernii/gauge.js@1.3.7/dist/gauge.min.js"></script>
</head>
<body>
  <h1 style="margin-bottom:24px; color:#ffe27c; text-shadow:0 2px 14px #000;">Yaris Cross Dashboard Digital</h1>
  <div class="dashboard-container">
    <div class="gauges-col">
      <div class="gauge-blocks">
        <canvas id="velocimetro" width="210" height="210"></canvas>
        <canvas id="rpm" width="210" height="210"></canvas>
      </div>
      <div class="toyota-flow">
        <h3>Flujo batería híbrida</h3>
        <canvas id="flow-canvas" width="340" height="90"></canvas>
        <div class="status-carga" id="estado-flujo">Cargando...</div>
      </div>
    </div>
    <div class="digital-panels" id="digital-panels">
      <!-- Digital panels se generan por JS -->
    </div>
  </div>
  <script>
    // Configura los gauges de velocidad y RPM
    const velocOpts = {
      angle: 0.22,
      lineWidth: 0.36,
      radiusScale: 0.98,
      pointer: { length: 0.66, strokeWidth: 5.4, color: '#ffe27c' },
      staticLabels: { font: "15px Arial", labels: [0,30,60,90,120,150,180,210], color: "#ffe27c", fractionDigits: 0 },
      staticZones: [
        {strokeStyle: "#73e5ff", min: 0, max: 120},
        {strokeStyle: "#ffe27c", min: 120, max: 180},
        {strokeStyle: "#ff1a1a", min: 180, max: 210}
      ],
      limitMax: true, limitMin: true,
      colorStart: '#313b50', colorStop: '#272e36', strokeColor: '#232b32',
      highDpiSupport: true,
      renderTicks: { divisions: 7, divWidth: 1.5, divLength: 0.9, divColor: "#ffe27c",
                     subDivisions: 4, subLength: 0.55, subWidth: 0.9, subColor: "#406e88" }
    };
    const velGauge = new Gauge(document.getElementById("velocimetro")).setOptions(velocOpts);
    velGauge.maxValue = 210; velGauge.setMinValue(0); velGauge.set(0);

    const rpmOpts = JSON.parse(JSON.stringify(velocOpts));
    rpmOpts.staticLabels.labels = [0,1000,2000,3000,4000,5000,6000,7000];
    rpmOpts.staticZones = [
      {strokeStyle: "#6bff4a", min: 0, max: 3500},
      {strokeStyle: "#ffe27c", min: 3500, max: 5500},
      {strokeStyle: "#ff1a1a", min: 5500, max: 7000}
    ];
    rpmOpts.pointer.color = "#72ffd7";
    const rpmGauge = new Gauge(document.getElementById("rpm")).setOptions(rpmOpts);
    rpmGauge.maxValue = 7000; rpmGauge.setMinValue(0); rpmGauge.set(0);

    // Simula datos periódicamente
    let v = 0, r = 0, dir = 1, flujo = 0, t=0;
    function updateData() {
      // Simulación simple: cambia valores suavemente
      v = Math.max(0, Math.min(210, v + (Math.random()-0.5)*18*dir));
      r = Math.max(0, Math.min(7000, (v/210)*7000 + (Math.random()-0.5)*420));
      flujo = Math.sin(Date.now()/1300)*30; // valor entre -30 (descarga) y +30 (carga)
      t++;
      // Actualiza gauges
      velGauge.set(v);
      rpmGauge.set(r);

      // Actualiza gráfico de flujo batería
      drawFlowBattery(flujo);

      // Actualiza paneles digitales
      digitalPanels.forEach(panel => {
        // Simula valores realistas
        switch(panel.id) {
          case 'agua': panel.value = 85 + Math.sin(t/18)*8; break;
          case 'aceite': panel.value = 92 + Math.cos(t/12)*12; break;
          case 'combustible': panel.value = 42 + Math.abs(Math.cos(t/62)*40); break;
          case 'bateria12v': panel.value = 12.5 + Math.sin(t/90)*0.3; break;
          case 'tempint': panel.value = 23 + Math.sin(t/70)*2; break;
        }
        document.getElementById('panel-'+panel.id).innerHTML =
          `<span class="label">${panel.label}:</span> <span>${panel.value.toFixed(panel.decimals)}${panel.unit}</span>`;
      });
    }

    // Digital panels (puedes añadir más)
    const digitalPanels = [
      {id:'agua', label:'Temp. Agua', value:85, unit:'ºC', decimals:1},
      {id:'aceite', label:'Temp. Aceite', value:92, unit:'ºC', decimals:1},
      {id:'combustible', label:'Gasolina', value:53, unit:' L', decimals:0},
      {id:'bateria12v', label:'Batería 12V', value:12.6, unit:'V', decimals:2},
      {id:'tempint', label:'Temp. Interior', value:23.3, unit:'ºC', decimals:1}
    ];

    // Genera HTML para los digital-panels
    window.onload = function() {
      const dp = document.getElementById('digital-panels');
      digitalPanels.forEach(panel => {
        const div = document.createElement('div');
        div.className = 'digital-panel';
        div.id = 'panel-' + panel.id;
        div.innerHTML = `<span class="label">${panel.label}:</span> <span>${panel.value.toFixed(panel.decimals)}${panel.unit}</span>`;
        dp.appendChild(div);
      });
      setInterval(updateData, 1000);
    };

    // Dibuja el gráfico de flujo batería tipo Toyota
    function drawFlowBattery(flujo) {
      const canvas = document.getElementById('flow-canvas');
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // Dibuja el “motor” y la “batería”
      // Motor
      ctx.save();
      ctx.beginPath();
      ctx.arc(65, 45, 33, 0, 2*Math.PI); // motor circular
      ctx.fillStyle = '#2949c4';
      ctx.shadowColor = "#73e5ff";
      ctx.shadowBlur = 8;
      ctx.fill();
      ctx.restore();

      ctx.save();
      ctx.beginPath();
      ctx.arc(275, 45, 33, 0, 2*Math.PI); // batería circular
      ctx.fillStyle = '#62d142';
      ctx.shadowColor = "#6bff4a";
      ctx.shadowBlur = 8;
      ctx.fill();
      ctx.restore();

      // Etiquetas
      ctx.fillStyle = "#fff";
      ctx.font = "bold 16px Arial";
      ctx.fillText("Motor", 40, 105);
      ctx.fillText("Batería", 250, 105);

      // Dibuja la flecha (flujo)
      const cx = 98, cy = 45, cw = 146, ch = 0;
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(cx, cy-7);
      ctx.lineTo(cx+cw-13, cy-7);
      ctx.lineTo(cx+cw-13, cy-20);
      ctx.lineTo(cx+cw+16, cy+1);
      ctx.lineTo(cx+cw-13, cy+20);
      ctx.lineTo(cx+cw-13, cy+7);
      ctx.lineTo(cx, cy+7);
      ctx.closePath();

      // Color según flujo: verde si carga, naranja si descarga, gris si neutro
      let grad = ctx.createLinearGradient(cx,cy,cx+cw+14,cy);
      if (flujo > 3) {
        grad.addColorStop(0, "#bbff7a");
        grad.addColorStop(1, "#35ffae");
      } else if (flujo < -3) {
        grad.addColorStop(0, "#ffb94b");
        grad.addColorStop(1, "#ff3d00");
      } else {
        grad.addColorStop(0, "#c2c2c2");
        grad.addColorStop(1, "#b2b2b2");
      }
      ctx.fillStyle = grad;
      ctx.shadowColor = "#fff";
      ctx.shadowBlur = 6;
      ctx.fill();
      ctx.restore();

      // Etiqueta estado
      const estado = document.getElementById('estado-flujo');
      if(flujo > 3) estado.innerHTML = 'Cargando (+)';
      else if(flujo < -3) estado.innerHTML = 'Descargando (–)';
      else estado.innerHTML = 'Flujo neutro';
    }
  </script>
</body>
</html>
